<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¸»ä½“çš„å­¦ç¿’ä¿ƒé€²ã‚¢ãƒ—ãƒª</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: sans-serif;
      margin: 1rem;
      display: flex;
      justify-content: center;
    }
    .container { width: 800px; }
    section { margin-bottom: 2rem; }
    textarea, input, select, button {
      font-size: 1rem;
      padding: 0.5rem;
      margin-top: 0.5rem;
      width: 100%;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      vertical-align: top;
    }
    textarea.schedule-text {
      width: 100%;
      height: 3rem;
      resize: vertical;
    }
    .entry {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .entry input[type="text"] { flex: 2; }
    .entry input[type="number"] { flex: 1; }
    .post, .memo-item, .saved-item {
      border: 1px solid #ccc;
      padding: 0.5rem;
      margin-top: 1rem;
      border-radius: 8px;
      position: relative;
    }
    .delete-btn {
      position: absolute;
      top: 5px;
      right: 10px;
      cursor: pointer;
      color: red;
    }
    h2 { margin-top: 2rem; color: #2c3e50; }
    .sns-buttons {
      margin-top: 0.5rem;
    }
    .sns-buttons a {
      margin-right: 0.5rem;
      text-decoration: none;
      color: white;
      background: #1da1f2;
      padding: 0.3rem 0.6rem;
      border-radius: 5px;
      font-size: 0.9rem;
    }
    .sns-buttons a.line { background: #00b900; }
    .sns-buttons a.fb { background: #3b5998; }

    /* ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .stopwatch {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    .stopwatch-time {
      font-size: 1.5rem;
      width: 120px;
      text-align: center;
      font-weight: bold;
    }

    /* ã‚³ãƒ”ãƒ¼å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
    .copy-message {
      color: green;
      font-size: 0.9rem;
      display: none;
      margin-top: 0.3rem;
    }
  </style>
</head>
<body>
  <div class="container">
  <h1>ä¸»ä½“çš„å­¦ä¿®ä¿ƒé€²ã‚¢ãƒ—ãƒª</h1>

  <section>
    <h2>ç›®æ¨™ã‚’è¨­å®šã—ã‚ˆã†</h2>
    <textarea id="memoInput" placeholder="ä¾‹ï¼šã€å’è«–ã®ãƒ’ãƒ³ãƒˆã‚’æ¢ã™ã€ã€TOEICã§700ç‚¹ã‚’å–ã‚‹ã€ãªã©ã‚ãªãŸã®å­¦ä¿®ã®ç›®æ¨™ã‚’ç«‹ã¦ã‚ˆã†"></textarea>
    <div id="memoList"></div>
  </section>

  <section>
    <h2>å­¦ä¿®ã®è¨ˆç”»ã‚’ç«‹ã¦ã‚ˆã†</h2>
    <h3>â‘  ç›®æ¨™ã«å¯¾ã—ã¦ã®ç¾åœ¨åœ°ã‚’è¨˜è¿°</h3>
    <textarea rows="4" id="currentStatus" placeholder="è‡ªåˆ†ãŒä»Šã©ã®æ®µéšã‹ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†"></textarea>
    <h3>â‘¡ å­¦ä¿®ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç«‹ã¦ã‚‹</h3>
    <table>
      <thead>
        <tr><th>æ—¥ä»˜</th><th>å­¦ç¿’å†…å®¹</th><th>æ–¹æ³•ãƒ»ãƒ„ãƒ¼ãƒ«</th></tr>
      </thead>
      <tbody id="schedule-table">
        <tr>
          <td><input type="date" value=""></td>
          <td><textarea class="schedule-text" placeholder="ä¾‹ï¼šè«–æ–‡ã‚’èª¿ã¹ã‚‹"></textarea></td>
          <td><textarea class="schedule-text" placeholder="ä¾‹ï¼šãƒ¡ãƒ¢å¸³ï¼‹ç¿»è¨³ã‚µã‚¤ãƒˆ"></textarea></td>
        </tr>
      </tbody>
    </table>
    <button onclick="addScheduleRow()">ï¼‹ è¡Œã‚’è¿½åŠ </button>
  </section>

  <section>
    <h2>å›°ã£ãŸã¨ãã®ã‚µãƒãƒ¼ãƒˆãƒ„ãƒ¼ãƒ«</h2>
    <select id="problemSelect">
      <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
      <option value="kanji">æ¼¢å­—ãŒèª­ã‚ãªã„</option>
      <option value="english">è‹±èªã®ã‚µã‚¤ãƒˆãŒèª­ã‚ãªã„</option>
      <option value="math">æ•°å¼ã®è¨ˆç®—ã‚’ã—ãŸã„</option>
      <option value="paper">è«–æ–‡ã‚’æ¢ã—ãŸã„</option>
    </select>
    <div id="toolBox"></div>
  </section>

  <section>
    <h2>ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒï¼ˆå­¦ç¿’æ™‚é–“ã®ç›®å®‰ã«ï¼‰</h2>
    <div class="stopwatch">
      <div id="timeDisplay" class="stopwatch-time">00:00:00</div>
      <button onclick="startStopwatch()">â–¶ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
      <button onclick="stopStopwatch()">â¸ ã‚¹ãƒˆãƒƒãƒ—</button>
      <button onclick="resetStopwatch()">ğŸ” ãƒªã‚»ãƒƒãƒˆ</button>
    </div>
  </section>

  <section>
    <h2>ä»Šæ—¥ã®å­¦ã³ã‚’æŒ¯ã‚Šè¿”ã‚ã†</h2>
    <div id="entries">
      <div class="entry">
        <input type="text" placeholder="é …ç›®å" />
        <input type="number" min="0" value="0" /> æ™‚é–“
      </div>
    </div>
    <button onclick="addEntry()">ï¼‹ é …ç›®ã‚’è¿½åŠ </button>
    <button onclick="updateChart()">ã‚°ãƒ©ãƒ•ã«åæ˜ </button>
    <canvas id="studyChart" style="max-width: 100%; height: auto;"></canvas>
  </section>

  <section>
    <h2>ã‚ãªãŸã®è€ƒãˆã‚’å…±æœ‰ã—ã‚ˆã†</h2>
    <textarea id="postInput" placeholder="å­¦ä¿®ã—ãŸå†…å®¹ã‚„è€ƒå¯Ÿã‚’å…±æœ‰ã—ã¦æ–°ãŸãªçŸ¥è¦‹ã‚’å¾—ã‚ˆã†"></textarea>
    <button onclick="copyPost()">ã‚³ãƒ”ãƒ¼ã™ã‚‹</button>
    <div class="copy-message" id="copyMessage">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</div>
    <div id="postList"></div>
    <div class="sns-buttons">
      <a href="https://twitter.com/intent/tweet?text=" target="_blank">X</a>
      <a href="https://social-plugins.line.me/lineit/share?url=https://example.com" target="_blank" class="line">LINE</a>
      <a href="https://discord.com/channels/@me" target="_blank" style="background:#5865F2;">Discord</a>
      <a href="https://www.facebook.com/sharer/sharer.php?u=https://example.com" target="_blank" class="fb">Facebook</a>
    </div>
  </section>

  <button onclick="saveAll()"> å…¨é …ç›®ã‚’ä¿å­˜ã™ã‚‹</button>
  <h2>ä¿å­˜ã—ãŸå†…å®¹</h2>
  <div id="savedList"></div>

  </div>

  <script>
    // ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚«ãƒ©ãƒ¼ç”Ÿæˆ
    function getUniqueColors(n) {
      const baseColors = ["#4e79a7", "#f28e2b", "#e15759", "#76b7b2", "#59a14f", "#edc948"];
      let colors = [];
      for (let i = 0; i < n; i++) {
        colors.push(baseColors[i % baseColors.length]);
      }
      return colors;
    }

    // è¨ˆç”»
    function addScheduleRow() {
      const today = new Date().toISOString().split("T")[0];
      const table = document.getElementById('schedule-table');
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input type="date" value="${today}"></td>
        <td><textarea class="schedule-text" placeholder="å­¦ç¿’å†…å®¹"></textarea></td>
        <td><textarea class="schedule-text" placeholder="æ–¹æ³•ãƒ»ãƒ„ãƒ¼ãƒ«"></textarea></td>
      `;
      table.appendChild(row);
    }
    document.querySelector("#schedule-table input[type='date']").value = new Date().toISOString().split("T")[0];

    // é¸æŠ
    const toolBox = document.getElementById("toolBox");
    document.getElementById("problemSelect").addEventListener("change", function () {
      const value = this.value;
      if (value === "kanji") {
        toolBox.innerHTML = '<ul><li><a href="https://mojinavi.com/tegaki" target="_blank">æ¼¢å­—æ‰‹æ›¸ãæ¤œç´¢</a></li></ul>';
      } else if (value === "english") {
        toolBox.innerHTML = '<ul><li><a href="https://translate.google.com/" target="_blank">Google ç¿»è¨³</a></li><li><a href="https://deepl.com/" target="_blank">DeepL ç¿»è¨³</a></li></ul>';
      } else if (value === "math") {
        toolBox.innerHTML = '<ul><li><a href="https://ja.wolframalpha.com/" target="_blank">WolframAlpha</a></li></ul>';
      } else if (value === "paper") {
        toolBox.innerHTML = '<ul><li><a href="https://www.jstage.jst.go.jp/browse/-char/ja" target="_blank">J-STAGE</a></li><li><a href="https://cir.nii.ac.jp/" target="_blank">CiNii Research</a></li></ul>';
      } else {
        toolBox.innerHTML = "";
      }
    });

    // ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒ
    let startTime, timerInterval;
    function updateStopwatch() {
      const elapsed = new Date(Date.now() - startTime);
      const h = String(elapsed.getUTCHours()).padStart(2, "0");
      const m = String(elapsed.getUTCMinutes()).padStart(2, "0");
      const s = String(elapsed.getUTCSeconds()).padStart(2, "0");
      document.getElementById("timeDisplay").textContent = `${h}:${m}:${s}`;
    }
    function startStopwatch() {
      if (!timerInterval) {
        startTime = Date.now();
        timerInterval = setInterval(updateStopwatch, 1000);
      }
    }
    function stopStopwatch() {
      clearInterval(timerInterval);
      timerInterval = null;
    }
    function resetStopwatch() {
      stopStopwatch();
      document.getElementById("timeDisplay").textContent = "00:00:00";
    }

    // èª¿æ•´
    const ctx = document.getElementById("studyChart").getContext("2d");
    const chart = new Chart(ctx, {
      type: "bar",
      data: { labels: [], datasets: [{ label: "å­¦ç¿’æ™‚é–“ï¼ˆæ™‚é–“ï¼‰", data: [], backgroundColor: [] }] },
      options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });
    function addEntry() {
      const div = document.createElement("div");
      div.className = "entry";
      div.innerHTML = '<input type="text" placeholder="é …ç›®å" /><input type="number" min="0" value="0" /> æ™‚é–“';
      document.getElementById("entries").appendChild(div);
    }
    function updateChart() {
      const entries = document.querySelectorAll("#entries .entry");
      const labels = [], data = [];
      entries.forEach(entry => {
        const name = entry.querySelector("input[type='text']").value.trim();
        const time = Number(entry.querySelector("input[type='number']").value);
        if (name && !isNaN(time)) {
          labels.push(name);
          data.push(time);
        }
      });
      chart.data.labels = labels;
      chart.data.datasets[0].data = data;
      chart.data.datasets[0].backgroundColor = getUniqueColors(labels.length);
      chart.update();
    }

    // ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½ï¼ˆè¿½åŠ ï¼‰
    function copyPost() {
      const text = document.getElementById("postInput").value;
      navigator.clipboard.writeText(text).then(() => {
        const msg = document.getElementById("copyMessage");
        msg.style.display = "block";
        setTimeout(() => msg.style.display = "none", 2000);
      });
    }

    // ä¿å­˜
    function saveAll() {
      const today = new Date().toLocaleString();
      const memo = document.getElementById("memoInput").value.trim();
      const current = document.getElementById("currentStatus").value.trim();
      const schedules = Array.from(document.querySelectorAll("#schedule-table tr")).map(tr =>
        Array.from(tr.querySelectorAll("input, textarea")).map(input => input.value)
      );
      const entries = Array.from(document.querySelectorAll("#entries .entry")).map(e => ({
        name: e.querySelector("input[type='text']").value,
        time: e.querySelector("input[type='number']").value
      }));
      const post = document.getElementById("postInput").value.trim();

      const saved = JSON.parse(localStorage.getItem("savedAll") || "[]");
      saved.unshift({ date: today, memo, current, schedules, entries, post });
      localStorage.setItem("savedAll", JSON.stringify(saved));
      loadSaved();
    }

    function deleteSaved(index) {
      const saved = JSON.parse(localStorage.getItem("savedAll") || "[]");
      saved.splice(index, 1);
      localStorage.setItem("savedAll", JSON.stringify(saved));
      loadSaved();
    }

    function loadSaved() {
      const saved = JSON.parse(localStorage.getItem("savedAll") || "[]");
      const savedList = document.getElementById("savedList");
      savedList.innerHTML = "";
      saved.forEach((item, i) => {
        const div = document.createElement("div");
        div.className = "saved-item";
        div.innerHTML = `
          <span class="delete-btn" onclick="deleteSaved(${i})">âœ–</span>
          <b>ä¿å­˜æ—¥æ™‚:</b> ${item.date}<br>
          <b>ç›®æ¨™:</b> ${item.memo}<br>
          <b>ç¾åœ¨åœ°:</b> ${item.current}<br>
          <b>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«:</b> ${item.schedules.map(s => s.join(" / ")).join(", ")}<br>
          <b>å­¦ç¿’æ™‚é–“:</b> ${item.entries.map(e => e.name + ":" + e.time + "h").join(", ")}<br>
          <b>æŠ•ç¨¿:</b> ${item.post}
        `;
        savedList.appendChild(div);
      });
    }

    window.onload = loadSaved;
  </script>
</body>
</html>
